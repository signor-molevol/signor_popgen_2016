chr3L<-read.table("chr3L_ld_filt.ld", as.is=TRUE, header=TRUE)
chr3R<-read.table("chr3R_ld_filt.ld", as.is=TRUE, header=TRUE)
chr2L<-read.table("chr2L_ld_filt.ld", as.is=TRUE, header=TRUE)
chrX<-read.table("chrX_ld_agg.ld", as.is=TRUE, header=TRUE)
chr2R<-read.table("chr2R_ld_filt.ld", as.is=TRUE, header=TRUE)

chr3L<-read.table("3L_ld_vcf.geno.ld", as.is=TRUE, header=TRUE)
chr2R<-read.table("2R_ld_vcf.geno.ld", as.is=TRUE, header=TRUE)
chrX<-read.table("2R_ld_vcf.geno.ld", as.is=TRUE, header=TRUE)

chr3L$diff<-(chr3L$POS2 - chr3L$POS1)
chr3R$diff<-(chr3R$POS2 - chr3R$POS1)
chr2L$diff<-(chr2L$POS2 - chr2L$POS1)
chr2R$diff<-(chr2R$POS2 - chr2R$POS1)
chrX$diff<-(chrX$POS2 - chrX$POS1)

chr3L$bins <- cut(chr3L$diff, breaks=c(0,20,40,60,80,100,120,140,160,180,200,220,240,260,280,300,450,600,750,900,1050,1300,1450, 1600,1750,1900,2050,2300,2450,2600,2750,2900,3050,3300,3450,3600,3750,3900,4050,4300,4450,4600,4750,4900,5050,5300,5450,5600,5750,5900,6050,6300,6450,6600,6750,6900,7050,7300,7450,7600,7750,7900, 8050,8300,8450,8600,8750,8900,9050,9300,9450,9600,9750,9900,10050))
chr3R$bins <- cut(chr3R$diff, breaks=c(0,20,40,60,80,100,120,140,160,180,200,220,240,260,280,300,450,600,750,900,1050,1300,1450, 1600,1750,1900,2050,2300,2450,2600,2750,2900,3050,3300,3450,3600,3750,3900,4050,4300,4450,4600,4750,4900,5050,5300,5450,5600,5750,5900,6050,6300,6450,6600,6750,6900,7050,7300,7450,7600,7750,7900, 8050,8300,8450,8600,8750,8900,9050,9300,9450,9600,9750,9900,10050))
chr2L$bins <- cut(chr2L$diff, breaks=c(0,20,40,60,80,100,120,140,160,180,200,220,240,260,280,300,450,600,750,900,1050,1300,1450, 1600,1750,1900,2050,2300,2450,2600,2750,2900,3050,3300,3450,3600,3750,3900,4050,4300,4450,4600,4750,4900,5050,5300,5450,5600,5750,5900,6050,6300,6450,6600,6750,6900,7050,7300,7450,7600,7750,7900, 8050,8300,8450,8600,8750,8900,9050,9300,9450,9600,9750,9900,10050))
chr2R$bins <- cut(chr2R$diff, breaks=c(0,20,40,60,80,100,120,140,160,180,200,220,240,260,280,300,450,600,750,900,1050,1300,1450, 1600,1750,1900,2050,2300,2450,2600,2750,2900,3050,3300,3450,3600,3750,3900,4050,4300,4450,4600,4750,4900,5050,5300,5450,5600,5750,5900,6050,6300,6450,6600,6750,6900,7050,7300,7450,7600,7750,7900, 8050,8300,8450,8600,8750,8900,9050,9300,9450,9600,9750,9900,10050))
chrX$bins <- cut(chrX$diff, breaks=c(0,20,40,60,80,100,120,140,160,180,200,220,240,260,280,300,450,600,750,900,1050,1300,1450, 1600,1750,1900,2050,2300,2450,2600,2750,2900,3050,3300,3450,3600,3750,3900,4050,4300,4450,4600,4750,4900,5050,5300,5450,5600,5750,5900,6050,6300,6450,6600,6750,6900,7050,7300,7450,7600,7750,7900, 8050,8300,8450,8600,8750,8900,9050,9300,9450,9600,9750,9900,10050))

chr3L2<-as.data.frame(mean.wt<-tapply(chr3L$R.2, chr3L$bins, mean))
chr3R2<-as.data.frame(mean.wt<-tapply(chr3R$R.2, chr3R$bins, mean))
chr2L2<-as.data.frame(mean.wt<-tapply(chr2L$R.2, chr2L$bins, mean))
chr2R2<-as.data.frame(mean.wt<-tapply(chr2R$R.2, chr2R$bins, mean))
chrX2<-as.data.frame(mean.wt<-tapply(chrX$R.2, chrX$bins, mean))

names(chr3L2)[1]<-"R2"
names(chr3R2)[1]<-"R2"
names(chr2L2)[1]<-"R2"
names(chr2R2)[1]<-"R2"
names(chrX2)[1]<-"R2"

chr3L2$log<-log10(chr3L2$R2)
chr3R2$log<-log10(chr3R2$R2)
chr2L2$log<-log10(chr2L2$R2)
chr2R2$log<-log10(chr2R2$R2)
chrX2$log<-log10(chrX2$R2)

chr3L2$dist<-c(20,40,60,80,100,120,140,160,180,200,220,240,260,280,300,450,600,750,900,1050,1300,1450, 1600,1750,1900,2050,2300,2450,2600,2750,2900,3050,3300,3450,3600,3750,3900,4050,4300,4450,4600,4750,4900,5050,5300,5450,5600,5750,5900,6050,6300,6450,6600,6750,6900,7050,7300,7450,7600,7750,7900, 8050,8300,8450,8600,8750,8900,9050,9300,9450,9600,9750,9900,10050)
chr3R2$dist<-c(20,40,60,80,100,120,140,160,180,200,220,240,260,280,300,450,600,750,900,1050,1300,1450, 1600,1750,1900,2050,2300,2450,2600,2750,2900,3050,3300,3450,3600,3750,3900,4050,4300,4450,4600,4750,4900,5050,5300,5450,5600,5750,5900,6050,6300,6450,6600,6750,6900,7050,7300,7450,7600,7750,7900, 8050,8300,8450,8600,8750,8900,9050,9300,9450,9600,9750,9900,10050)
chr2L2$dist<-c(20,40,60,80,100,120,140,160,180,200,220,240,260,280,300,450,600,750,900,1050,1300,1450, 1600,1750,1900,2050,2300,2450,2600,2750,2900,3050,3300,3450,3600,3750,3900,4050,4300,4450,4600,4750,4900,5050,5300,5450,5600,5750,5900,6050,6300,6450,6600,6750,6900,7050,7300,7450,7600,7750,7900, 8050,8300,8450,8600,8750,8900,9050,9300,9450,9600,9750,9900,10050)
chr2R2$dist<-c(20,40,60,80,100,120,140,160,180,200,220,240,260,280,300,450,600,750,900,1050,1300,1450, 1600,1750,1900,2050,2300,2450,2600,2750,2900,3050,3300,3450,3600,3750,3900,4050,4300,4450,4600,4750,4900,5050,5300,5450,5600,5750,5900,6050,6300,6450,6600,6750,6900,7050,7300,7450,7600,7750,7900, 8050,8300,8450,8600,8750,8900,9050,9300,9450,9600,9750,9900,10050)
chrX2$dist<-c(20,40,60,80,100,120,140,160,180,200,220,240,260,280,300,450,600,750,900,1050,1300,1450, 1600,1750,1900,2050,2300,2450,2600,2750,2900,3050,3300,3450,3600,3750,3900,4050,4300,4450,4600,4750,4900,5050,5300,5450,5600,5750,5900,6050,6300,6450,6600,6750,6900,7050,7300,7450,7600,7750,7900, 8050,8300,8450,8600,8750,8900,9050,9300,9450,9600,9750,9900,10050)
par(mai=c(2.4, 1.4, 2.4, 1.4))
plot(chr3L2$dist, chr3L2$R2, type="l", lwd=3, col="dark blue", ylab="LD", xlab="Distance")
par(new=T)
plot(chr3R2$dist, chr3R2$R2, type="l", lwd=3, col="dark magenta", xlab='', ylab='', axes=F)
par(new=T)
plot(chr2R2$dist, chr2R2$R2, type="l", lwd=3, col="dark green", xlab='', ylab='', axes=F)
par(new=T)
plot(chr2L2$dist, chr2L2$R2, type="l", lwd=3, col="goldenrod",  xlab='', ylab='', axes=F)
par(new=T)
plot(chrX2$dist, chrX2$R2, type="l", lwd=3, col="cornflower blue",  xlab='', ylab='', axes=F)

plot(chr3L2$dist, chr3L2$log, type="l", lwd=3, col="dark blue", ylab="LD", xlab="Distance", ylim=c(-1.1, -.3))
par(new=T)
plot(chr3R2$dist, chr3R2$log, type="l", lwd=3, col="dark magenta", xlab='', ylab='', axes=F,ylim=c(-1.1, -.3))
par(new=T)
plot(chr2R2$dist, chr2R2$log, type="l", lwd=3, col="dark green", xlab='', ylab='', axes=F,ylim=c(-1.1, -.3))
par(new=T)
plot(chr2L2$dist, chr2L2$log, type="l", lwd=3, col="goldenrod", xlab='', ylab='', axes=F,ylim=c(-1.1, -.3))
par(new=T)
plot(chrX2$dist, chrX2$log, type="l", lwd=3, col="cornflower blue", xlab='', ylab='', axes=F,ylim=c(-1.1, -.3))
legend("topright", fill=c("dark blue", "dark magenta", "dark green", "goldenrod", "cornflower blue"), legend=c("3L", "3R", "2L", "2R", "X"))